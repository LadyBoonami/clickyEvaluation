<!doctype html>
<html>
  <head>
    <title>Clicky Evaluation</title>
    <meta charset="utf8">
    <link rel="stylesheet" href="style.css" charset="utf-8">
  </head>
  <body>
    <script charset="utf-8" src="../node_modules/jquery/dist/jquery.js"></script>
    <script charset="utf-8" src="dist/Main.js"></script>
    <script charset="utf-8">
      PS.Main.main();
    </script>

    <h3>Expression</h3>
    <input type="text" id="input" size="120" value="1 + (2 * 3) + sum (map square [1, 2, 3, 4])">

    <div id="output-container">
      <div id="output"></div>
    </div>

    <h3>Definitions</h3>
    <textarea id="definitions" cols="120" rows="15">
and = foldl (&&) True
or = foldl (||) False

all p = and . map p
any p = or . map p

head (x:xs) = x
tail (x:xs) = xs

take 0 xs     = []
take n (x:xs) = x : take (n - 1) xs

drop 0 xs     = xs
drop n (x:xs) = drop (n - 1) xs

elem e []     = False
elem e (x:xs) = if (e == x) True (elem e xs)

max a b = if (a >= b) a b
min a b = if (b >= a) a b

maximum (x:xs) = foldl max x xs
minimum (x:xs) = foldl min x xs

length []     = 0
length (x:xs) = 1 + length xs

sum = foldr (+) 0
product = foldr (*) 1

reverse []     = []
reverse (x:xs) = reverse xs ++ [x]

concat = foldr (++) []

map f []     = []
map f (x:xs) = f x : map f xs

if True  a b = a
if False a b = b

not True  = False
not False = True

filter p (x:xs) = if (p x) (x : filter p xs) (filter p xs)
filter p []     = []

foldr f ini []     = ini
foldr f ini (x:xs) = f x (foldr f ini xs)

foldl f acc []     = acc
foldl f acc (x:xs) = foldl f (f acc x) xs

scanl f b []     = [b]
scanl f b (x:xs) = b : scanl f (f b x) xs

id x = x

flip f x y = f y x

even n = (n `mod` 2) == 0
odd n = (n `mod` 2) == 1

fix f = f (fix f)
</textarea>

    <div id="info"></div>
  </body>
</html>
